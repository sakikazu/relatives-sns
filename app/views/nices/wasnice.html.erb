<script>
$(document).ready(function() {
  //目次を作成する
  $("#mokuji").mokuji();

  //colorbox 再適用
  $(".colorbox").colorbox();
  colorbox_fix_size();
})
</script>

<div id="nice_show" style="width:900px">

<%= render :partial => 'nices_menu' %>


<h1 style="margin-top:45px">＜<%= @user.dispname %>＞がイイネされたもの</h1>

<div id="nice_show_left">

<div id="mokuji"></div>

<h2 class="normal">人気のつぶやき</h2>
<div class="h2normal_content">
<% @mutter_data.each_with_index do |data, idx| -%>
  <% obj = Mutter.find_by_id(data[:id]) -%>
  <div class="nice_rank">
    <%= idx + 1 %>位：<%= data[:count] %> イイネ
    <span class="nice_user">(イイネした人： <%= obj.nices.map{|n| n.user.dispname}.join(" / ") %>)</span>
  </div>
  <% if obj.present? -%>
    <ul class="mutter_rows">
      <%= render :partial => 'mutters/mutter_row', :locals => {:mutter_row => obj} %>
    </ul>
  <% else -%>
    削除されました.
  <% end -%>
  <hr>
<% end -%>
</div>

<h2 class="normal">人気の写真</h2>
<div class="h2normal_content">
<% @photo_data.each_with_index do |data, idx| -%>
  <% obj = Photo.find_by_id(data[:id]) -%>
  <div class="nice_rank">
    <%= idx + 1 %>位：<%= data[:count] %> イイネ
    <span class="nice_user">(イイネした人： <%= obj.nices.map{|n| n.user.dispname}.join(" / ") %>)</span>
  </div>
  <% if obj.present? -%>
    <%= link_to(image_tag(obj.attach(:thumb)), slideshow_album_photo_path(obj), {:class => colorbox_fix_size}) if obj.attach?  %><br>
    写真タイトル：<%= obj.title %> / アルバム：<%= link_to obj.album.title, obj.album %>
  <% else -%>
    削除されました.
  <% end -%>
  <hr>
<% end -%>
</div>

<h2 class="normal">人気の日記</h2>
<div class="h2normal_content">
<% @blog_data.each_with_index do |data, idx| -%>
  <% obj = Blog.find_by_id(data[:id]) -%>
  <div class="nice_rank">
    <%= idx + 1 %>位：<%= data[:count] %> イイネ
    <span class="nice_user">(イイネした人： <%= obj.nices.map{|n| n.user.dispname}.join(" / ") %>)</span>
  </div>
  <% if obj.present? -%>
    <% if obj.blog_images.size > 0 -%>
      <% b_image = obj.blog_images.first -%>
      <%= image_tag(b_image.image(:thumb)) if b_image.image? %><br>
    <% end -%>
    日記：<%= link_to obj.title, blog_path(obj) %><br>
    <%= nice_author_and_created_at(obj) %>
  <% else -%>
    削除されました.
  <% end -%>
  <hr>
<% end -%>
</div>

<h2 class="normal">人気の動画</h2>
<div class="h2normal_content">
<% @movie_data.each_with_index do |data, idx| -%>
  <% obj = Movie.find_by_id(data[:id]) -%>
  <div class="nice_rank">
    <%= idx + 1 %>位：<%= data[:count] %> イイネ
    <span class="nice_user">(イイネした人： <%= obj.nices.map{|n| n.user.dispname}.join(" / ") %>)</span>
  </div>
  <% if obj.present? -%>
    動画：<%= link_to obj.title, movie_path(obj) %><br>
    <%= image_tag(obj.thumb(:thumb)) + '<br>' if obj.thumb?  %>
    <%= nice_author_and_created_at(obj) %>
  <% else -%>
    削除されました.
  <% end -%>
  <hr>
<% end -%>
</div>


</div> <!-- #nice_show_left -->


<div class="right_side_bar" style="width:180px;margin-top:30px;">
    <p class="title">イイネされたことがある人</p>
    <ul>
    <% @users.each do |user| -%>
      <li><%= link_to user.dispname(User::FULLNAME), wasnice_nices_path(:user_id => user.id) %></li>
    <% end -%>
    </ul>
</div>

</div> <!-- #nice_show -->
